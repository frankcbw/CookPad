{"ast":null,"code":"import _classCallCheck from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Container from\"@material-ui/core/Container\";import'./viewProfile.css';import Navbar from\"../Navbar/navbar.component\";import RecipeList from'../recipelist/recipelist.component';import Avatar from'react-avatar';import{Collapse}from'react-bootstrap';import{DeleteFromRecipeList,addToRecipeList}from'../../actions/user';import{setRecipe}from'../../actions/recipe';// hard coded images\nimport ProfilePic from'./default-profile-pic.png';import{FaRegEdit,FaRegSave}from\"react-icons/fa\";import{getUser}from\"../../actions/user\";import{getMyRecipe,getMyCollection}from\"../../actions/recipe\";var ViewProfile=/*#__PURE__*/function(_Component){_inherits(ViewProfile,_Component);var _super=_createSuper(ViewProfile);function ViewProfile(props){var _this;_classCallCheck(this,ViewProfile);_this=_super.call(this,props);_this.handleRecipeExpandClick=function(){if(_this.state.recipeExpanded){_this.setState({recipeExpanded:false});}else{_this.setState({recipeExpanded:true});}};_this.handleCollectionExpandClick=function(){if(_this.state.collectionExpanded){_this.setState({collectionExpanded:false});}else{_this.setState({collectionExpanded:true});}};_this.clickHeart=function(rid){var newLikes=0;var new_recipes=[];var new_collectedRecipes=[];if(_this.props.app.state.currentUser.likedRecipes.includes(rid)){_this.props.app.state.currentUser.likedRecipes=_this.props.app.state.currentUser.likedRecipes.filter(function(recipe){return recipe!==rid;});DeleteFromRecipeList(_this.props.app.state.currentUser._id,{likedRecipes:rid});_this.state.recipes.forEach(function(recipe){var new_recipe=Object.create(recipe);if(recipe._id===rid){new_recipe.likes--;newLikes=new_recipe.likes;}new_recipes.push(new_recipe);});_this.setState({recipes:new_recipes});_this.state.collectedRecipes.forEach(function(recipe){var new_recipe=Object.create(recipe);if(new_recipe._id===rid){new_recipe.likes--;}new_collectedRecipes.push(new_recipe);});_this.setState({collectedRecipes:new_collectedRecipes});}else{_this.props.app.state.currentUser.likedRecipes.push(rid);addToRecipeList(_this.props.app.state.currentUser._id,{likedRecipes:rid});_this.state.recipes.forEach(function(recipe){var new_recipe=Object.create(recipe);if(recipe._id===rid){new_recipe.likes++;newLikes=new_recipe.likes;}new_recipes.push(new_recipe);});_this.setState({recipes:new_recipes});_this.state.collectedRecipes.forEach(function(recipe){var new_recipe=Object.create(recipe);if(new_recipe._id===rid){new_recipe.likes++;}new_collectedRecipes.push(new_recipe);});_this.setState({collectedRecipes:new_collectedRecipes});}// server call to update recipe\nsetRecipe(rid,{likes:newLikes});};_this.clickStar=function(rid){if(_this.props.app.state.currentUser.collectedRecipes.includes(rid)){_this.props.app.state.currentUser.collectedRecipes=_this.props.app.state.currentUser.collectedRecipes.filter(function(recipe){return recipe!==rid;});DeleteFromRecipeList(_this.props.app.state.currentUser._id,{collectedRecipes:rid});}else{_this.props.app.state.currentUser.collectedRecipes.push(rid);addToRecipeList(_this.props.app.state.currentUser._id,{collectedRecipes:rid});}_this.setState({dummy:0});};_this.onClose=function(e){_this.setState({preview:null});};_this.onCrop=function(e,preview){_this.setState({preview:preview});};_this.onChangePassword=function(e){e.preventDefault();_this.state.user.password=e.target.value;};_this.onChangeDescription=function(e){e.preventDefault();_this.state.user.description=e.target.value;};_this.editProfile=function(e){e.preventDefault();// this.props.history.push(\"/editprofile/\"+ this.state.uid);\n_this.setState({inEdit:true});};_this.saveProfile=function(e){e.preventDefault();_this.setState({inEdit:false});};_this.editButtonGenerator=function(app){if(app.state.currentUser._id===_this.state.user._id){return/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-primary\",onClick:_this.editProfile},/*#__PURE__*/React.createElement(FaRegEdit,null),\"Edit Profile\");}};_this.profileGenerator=function(app){if(!_this.state.inEdit){return/*#__PURE__*/React.createElement(\"div\",{id:\"user-profile\"},/*#__PURE__*/React.createElement(\"h4\",null,_this.state.user.username+\"'s Profile\"),/*#__PURE__*/React.createElement(Avatar,{id:\"user-picture\",name:\"user\",size:\"150\",round:true,src:_this.state.userpicture.src}),/*#__PURE__*/React.createElement(\"div\",{id:\"user-description\"},_this.state.user.description),_this.editButtonGenerator(app));}else{return/*#__PURE__*/React.createElement(\"div\",{id:\"user-profile\"},/*#__PURE__*/React.createElement(\"h4\",null,_this.state.username+\"'s Profile\"),/*#__PURE__*/React.createElement(\"form\",{onSubmit:_this.saveProfile},/*#__PURE__*/React.createElement(\"div\",{id:\"picture-change\"},/*#__PURE__*/React.createElement(Avatar,{width:200,height:200,round:true,onCrop:_this.onCrop,onClose:_this.onClose,src:_this.state.userpicture.src})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\",id:\"profile-input\"},/*#__PURE__*/React.createElement(\"div\",null,\"Change Password:\"),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",className:\"form-control\",value:_this.state.user.password,onChange:_this.onChangePassword}),/*#__PURE__*/React.createElement(\"div\",null,\"Change Profile Description:\"),/*#__PURE__*/React.createElement(\"textarea\",{className:\"form-control\",value:_this.state.user.description,onChange:_this.onChangeDescription}),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-primary\",onClick:_this.saveProfile},/*#__PURE__*/React.createElement(FaRegSave,null),\"Save Profile\"))));}};_this.RecipeExpandButtonGenerator=function(){if(_this.state.recipeExpanded){return/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-primary\",onClick:_this.handleRecipeExpandClick},\"Collapse\");}else{return/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-primary\",onClick:_this.handleRecipeExpandClick},\"View\");}};_this.CollectionExpandButtonGenerator=function(){if(_this.state.collectionExpanded){return/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-primary\",onClick:_this.handleCollectionExpandClick},\"Collapse\");}else{return/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-primary\",onClick:_this.handleCollectionExpandClick},\"View\");}};_this.clickRecipe=function(rid){_this.props.history.push(\"/viewrecipe/\"+rid);};_this.state={uid:_this.props.match.params.uid,user:{},userpicture:{src:ProfilePic},recipes:[],collectedRecipes:[],recipeExpanded:false,collectionExpanded:false,inEdit:false};_this.props.history.push('/viewprofile/'+_this.props.match.params.uid);console.log(_this.state.collectedRecipes);return _this;}_createClass(ViewProfile,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;getUser(this,function(){getMyRecipe(_this2);getMyCollection(_this2);});}},{key:\"enterKeyHandler\",value:function enterKeyHandler(e){e.preventDefault();if(e.keyCode===13){this.state.user.description=e.target.value+'\\n';};}},{key:\"render\",value:function render(){var app=this.props.app;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Container,{maxWidth:\"md\"},/*#__PURE__*/React.createElement(Navbar,{app:app}),this.profileGenerator(app),/*#__PURE__*/React.createElement(\"div\",{id:\"user-recipes\"},/*#__PURE__*/React.createElement(\"h4\",null,\"My Recipes\",/*#__PURE__*/React.createElement(this.RecipeExpandButtonGenerator,null)),/*#__PURE__*/React.createElement(Collapse,{in:this.state.recipeExpanded},/*#__PURE__*/React.createElement(\"div\",{className:\"recipe-list\"},/*#__PURE__*/React.createElement(RecipeList,{recipes:this.state.recipes,clickHeart:this.clickHeart,clickStar:this.clickStar,clickRecipe:this.clickRecipe,app:app})))),this.state.recipeExpanded&&/*#__PURE__*/React.createElement(\"div\",{id:\"collection-recipeswithEx\"},/*#__PURE__*/React.createElement(\"h4\",null,\"My Collection\",/*#__PURE__*/React.createElement(this.CollectionExpandButtonGenerator,null)),/*#__PURE__*/React.createElement(Collapse,{in:this.state.collectionExpanded},/*#__PURE__*/React.createElement(\"div\",{className:\"recipe-list\"},/*#__PURE__*/React.createElement(RecipeList,{recipes:this.state.collectedRecipes,clickHeart:this.clickHeart,clickStar:this.clickStar,clickRecipe:this.clickRecipe,app:this.props.app})))),!this.state.recipeExpanded&&/*#__PURE__*/React.createElement(\"div\",{id:\"collection-recipes\"},/*#__PURE__*/React.createElement(\"h4\",null,\"My Collection\",/*#__PURE__*/React.createElement(this.CollectionExpandButtonGenerator,null)),/*#__PURE__*/React.createElement(Collapse,{in:this.state.collectionExpanded},/*#__PURE__*/React.createElement(\"div\",{className:\"recipe-list\"},/*#__PURE__*/React.createElement(RecipeList,{recipes:this.state.collectedRecipes,clickHeart:this.clickHeart,clickStar:this.clickStar,clickRecipe:this.clickRecipe,app:this.props.app}))))));}}]);return ViewProfile;}(Component);export{ViewProfile as default};","map":{"version":3,"sources":["/Users/FrankChen/csc309/tp/team07/client/src/components/viewProfile/viewProfile.component.js"],"names":["React","Component","Container","Navbar","RecipeList","Avatar","Collapse","DeleteFromRecipeList","addToRecipeList","setRecipe","ProfilePic","FaRegEdit","FaRegSave","getUser","getMyRecipe","getMyCollection","ViewProfile","props","handleRecipeExpandClick","state","recipeExpanded","setState","handleCollectionExpandClick","collectionExpanded","clickHeart","rid","newLikes","new_recipes","new_collectedRecipes","app","currentUser","likedRecipes","includes","filter","recipe","_id","recipes","forEach","new_recipe","Object","create","likes","push","collectedRecipes","clickStar","dummy","onClose","e","preview","onCrop","onChangePassword","preventDefault","user","password","target","value","onChangeDescription","description","editProfile","inEdit","saveProfile","editButtonGenerator","profileGenerator","username","userpicture","src","RecipeExpandButtonGenerator","CollectionExpandButtonGenerator","clickRecipe","history","uid","match","params","console","log","keyCode"],"mappings":"4mBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAOC,CAAAA,SAAP,KAAsB,6BAAtB,CACA,MAAO,mBAAP,CACA,MAAOC,CAAAA,MAAP,KAAmB,4BAAnB,CACA,MAAOC,CAAAA,UAAP,KAAuB,oCAAvB,CACA,MAAOC,CAAAA,MAAP,KAAmB,cAAnB,CACA,OAAQC,QAAR,KAAuB,iBAAvB,CACA,OAAQC,oBAAR,CAA8BC,eAA9B,KAAoD,oBAApD,CACA,OAAQC,SAAR,KAAwB,sBAAxB,CAEA;AACA,MAAOC,CAAAA,UAAP,KAAsB,2BAAtB,CACA,OAASC,SAAT,CAAoBC,SAApB,KAAqC,gBAArC,CACA,OAAQC,OAAR,KAAsB,oBAAtB,CACA,OAAQC,WAAR,CAAqBC,eAArB,KAA2C,sBAA3C,C,GAEqBC,CAAAA,W,0GACjB,qBAAYC,KAAZ,CAAkB,6CACd,uBAAMA,KAAN,EADc,MA0BlBC,uBA1BkB,CA0BQ,UAAM,CAC5B,GAAG,MAAKC,KAAL,CAAWC,cAAd,CAA6B,CACzB,MAAKC,QAAL,CAAc,CAAED,cAAc,CAAE,KAAlB,CAAd,EACH,CAFD,IAEK,CACD,MAAKC,QAAL,CAAc,CAAED,cAAc,CAAE,IAAlB,CAAd,EACH,CACJ,CAhCiB,OAkClBE,2BAlCkB,CAkCW,UAAM,CAC/B,GAAG,MAAKH,KAAL,CAAWI,kBAAd,CAAiC,CAC7B,MAAKF,QAAL,CAAc,CAAEE,kBAAkB,CAAE,KAAtB,CAAd,EACH,CAFD,IAEK,CACD,MAAKF,QAAL,CAAc,CAAEE,kBAAkB,CAAE,IAAtB,CAAd,EACH,CACJ,CAxCiB,OA0CjBC,UA1CiB,CA0CN,SAACC,GAAD,CAAO,CACf,GAAIC,CAAAA,QAAQ,CAAG,CAAf,CACA,GAAMC,CAAAA,WAAW,CAAG,EAApB,CACA,GAAMC,CAAAA,oBAAoB,CAAG,EAA7B,CACA,GAAG,MAAKX,KAAL,CAAWY,GAAX,CAAeV,KAAf,CAAqBW,WAArB,CAAiCC,YAAjC,CAA8CC,QAA9C,CAAuDP,GAAvD,CAAH,CAA+D,CAC3D,MAAKR,KAAL,CAAWY,GAAX,CAAeV,KAAf,CAAqBW,WAArB,CAAiCC,YAAjC,CAAgD,MAAKd,KAAL,CAAWY,GAAX,CAAeV,KAAf,CAAqBW,WAArB,CAAiCC,YAAjC,CAA8CE,MAA9C,CAAqD,SAAAC,MAAM,QAAGA,CAAAA,MAAM,GAAKT,GAAd,EAA3D,CAAhD,CACAlB,oBAAoB,CAAC,MAAKU,KAAL,CAAWY,GAAX,CAAeV,KAAf,CAAqBW,WAArB,CAAiCK,GAAlC,CAAuC,CAACJ,YAAY,CAAEN,GAAf,CAAvC,CAApB,CACA,MAAKN,KAAL,CAAWiB,OAAX,CAAmBC,OAAnB,CAA2B,SAACH,MAAD,CAAU,CACjC,GAAMI,CAAAA,UAAU,CAAGC,MAAM,CAACC,MAAP,CAAcN,MAAd,CAAnB,CACA,GAAGA,MAAM,CAACC,GAAP,GAAeV,GAAlB,CAAsB,CAClBa,UAAU,CAACG,KAAX,GACAf,QAAQ,CAAGY,UAAU,CAACG,KAAtB,CACH,CACDd,WAAW,CAACe,IAAZ,CAAiBJ,UAAjB,EACH,CAPD,EAQA,MAAKjB,QAAL,CAAc,CAAEe,OAAO,CAAET,WAAX,CAAd,EAEA,MAAKR,KAAL,CAAWwB,gBAAX,CAA4BN,OAA5B,CAAoC,SAACH,MAAD,CAAU,CAC1C,GAAMI,CAAAA,UAAU,CAAGC,MAAM,CAACC,MAAP,CAAcN,MAAd,CAAnB,CACA,GAAGI,UAAU,CAACH,GAAX,GAAmBV,GAAtB,CAA0B,CACtBa,UAAU,CAACG,KAAX,GACH,CACDb,oBAAoB,CAACc,IAArB,CAA0BJ,UAA1B,EACH,CAND,EAOA,MAAKjB,QAAL,CAAc,CAAEsB,gBAAgB,CAAEf,oBAApB,CAAd,EACH,CArBD,IAqBK,CACD,MAAKX,KAAL,CAAWY,GAAX,CAAeV,KAAf,CAAqBW,WAArB,CAAiCC,YAAjC,CAA8CW,IAA9C,CAAmDjB,GAAnD,EACAjB,eAAe,CAAC,MAAKS,KAAL,CAAWY,GAAX,CAAeV,KAAf,CAAqBW,WAArB,CAAiCK,GAAlC,CAAuC,CAACJ,YAAY,CAAEN,GAAf,CAAvC,CAAf,CACA,MAAKN,KAAL,CAAWiB,OAAX,CAAmBC,OAAnB,CAA2B,SAACH,MAAD,CAAU,CACjC,GAAMI,CAAAA,UAAU,CAAGC,MAAM,CAACC,MAAP,CAAcN,MAAd,CAAnB,CACA,GAAGA,MAAM,CAACC,GAAP,GAAeV,GAAlB,CAAsB,CAClBa,UAAU,CAACG,KAAX,GACAf,QAAQ,CAAGY,UAAU,CAACG,KAAtB,CACH,CACDd,WAAW,CAACe,IAAZ,CAAiBJ,UAAjB,EACH,CAPD,EAQA,MAAKjB,QAAL,CAAc,CAAEe,OAAO,CAAET,WAAX,CAAd,EAEA,MAAKR,KAAL,CAAWwB,gBAAX,CAA4BN,OAA5B,CAAoC,SAACH,MAAD,CAAU,CAC1C,GAAMI,CAAAA,UAAU,CAAGC,MAAM,CAACC,MAAP,CAAcN,MAAd,CAAnB,CACA,GAAGI,UAAU,CAACH,GAAX,GAAmBV,GAAtB,CAA0B,CACtBa,UAAU,CAACG,KAAX,GACH,CACDb,oBAAoB,CAACc,IAArB,CAA0BJ,UAA1B,EACH,CAND,EAOA,MAAKjB,QAAL,CAAc,CAAEsB,gBAAgB,CAAEf,oBAApB,CAAd,EACH,CAED;AACAnB,SAAS,CAACgB,GAAD,CAAM,CAACgB,KAAK,CAAEf,QAAR,CAAN,CAAT,CACH,CA5FiB,OA8FlBkB,SA9FkB,CA8FR,SAACnB,GAAD,CAAO,CACb,GAAG,MAAKR,KAAL,CAAWY,GAAX,CAAeV,KAAf,CAAqBW,WAArB,CAAiCa,gBAAjC,CAAkDX,QAAlD,CAA2DP,GAA3D,CAAH,CAAmE,CAC/D,MAAKR,KAAL,CAAWY,GAAX,CAAeV,KAAf,CAAqBW,WAArB,CAAiCa,gBAAjC,CAAoD,MAAK1B,KAAL,CAAWY,GAAX,CAAeV,KAAf,CAAqBW,WAArB,CAAiCa,gBAAjC,CAAkDV,MAAlD,CAAyD,SAAAC,MAAM,QAAGA,CAAAA,MAAM,GAAKT,GAAd,EAA/D,CAApD,CACAlB,oBAAoB,CAAC,MAAKU,KAAL,CAAWY,GAAX,CAAeV,KAAf,CAAqBW,WAArB,CAAiCK,GAAlC,CAAuC,CAACQ,gBAAgB,CAAElB,GAAnB,CAAvC,CAApB,CACH,CAHD,IAGK,CACD,MAAKR,KAAL,CAAWY,GAAX,CAAeV,KAAf,CAAqBW,WAArB,CAAiCa,gBAAjC,CAAkDD,IAAlD,CAAuDjB,GAAvD,EACAjB,eAAe,CAAC,MAAKS,KAAL,CAAWY,GAAX,CAAeV,KAAf,CAAqBW,WAArB,CAAiCK,GAAlC,CAAuC,CAACQ,gBAAgB,CAAElB,GAAnB,CAAvC,CAAf,CACH,CACD,MAAKJ,QAAL,CAAc,CAACwB,KAAK,CAAE,CAAR,CAAd,EACH,CAvGiB,OAyGlBC,OAzGkB,CAyGV,SAACC,CAAD,CAAK,CACT,MAAK1B,QAAL,CAAc,CAAC2B,OAAO,CAAE,IAAV,CAAd,EACH,CA3GiB,OA6GlBC,MA7GkB,CA6GX,SAACF,CAAD,CAAGC,OAAH,CAAa,CAChB,MAAK3B,QAAL,CAAc,CAAC2B,OAAO,CAAPA,OAAD,CAAd,EACH,CA/GiB,OAiHlBE,gBAjHkB,CAiHD,SAACH,CAAD,CAAK,CAClBA,CAAC,CAACI,cAAF,GACA,MAAKhC,KAAL,CAAWiC,IAAX,CAAgBC,QAAhB,CAA2BN,CAAC,CAACO,MAAF,CAASC,KAApC,CACH,CApHiB,OAsHlBC,mBAtHkB,CAsHE,SAACT,CAAD,CAAK,CACrBA,CAAC,CAACI,cAAF,GACA,MAAKhC,KAAL,CAAWiC,IAAX,CAAgBK,WAAhB,CAA8BV,CAAC,CAACO,MAAF,CAASC,KAAvC,CACH,CAzHiB,OAkIlBG,WAlIkB,CAkIN,SAACX,CAAD,CAAK,CACbA,CAAC,CAACI,cAAF,GACA;AACA,MAAK9B,QAAL,CAAc,CAACsC,MAAM,CAAE,IAAT,CAAd,EACH,CAtIiB,OAwIlBC,WAxIkB,CAwIN,SAACb,CAAD,CAAK,CACbA,CAAC,CAACI,cAAF,GACA,MAAK9B,QAAL,CAAc,CAACsC,MAAM,CAAE,KAAT,CAAd,EAEH,CA5IiB,OA8IlBE,mBA9IkB,CA8IE,SAAChC,GAAD,CAAO,CACvB,GAAIA,GAAG,CAACV,KAAJ,CAAUW,WAAV,CAAsBK,GAAtB,GAA8B,MAAKhB,KAAL,CAAWiC,IAAX,CAAgBjB,GAAlD,CAAsD,CAClD,mBAAO,8BAAQ,IAAI,CAAC,QAAb,CACP,SAAS,CAAG,yBADL,CAEP,OAAO,CAAE,MAAKuB,WAFP,eAGP,oBAAC,SAAD,MAHO,gBAAP,CAMH,CAEJ,CAxJiB,OA0JlBI,gBA1JkB,CA0JC,SAACjC,GAAD,CAAO,CACtB,GAAI,CAAC,MAAKV,KAAL,CAAWwC,MAAhB,CAAuB,CACnB,mBAAQ,2BAAK,EAAE,CAAC,cAAR,eACI,8BAAK,MAAKxC,KAAL,CAAWiC,IAAX,CAAgBW,QAAhB,CAA2B,YAAhC,CADJ,cAEI,oBAAC,MAAD,EAAQ,EAAE,CAAC,cAAX,CAA0B,IAAI,CAAC,MAA/B,CAAsC,IAAI,CAAC,KAA3C,CAAiD,KAAK,CAAE,IAAxD,CAA8D,GAAG,CAAE,MAAK5C,KAAL,CAAW6C,WAAX,CAAuBC,GAA1F,EAFJ,cAGI,2BAAK,EAAE,CAAC,kBAAR,EAA4B,MAAK9C,KAAL,CAAWiC,IAAX,CAAgBK,WAA5C,CAHJ,CAIK,MAAKI,mBAAL,CAAyBhC,GAAzB,CAJL,CAAR,CAMH,CAPD,IAOO,CACH,mBAAQ,2BAAK,EAAE,CAAC,cAAR,eACI,8BAAK,MAAKV,KAAL,CAAW4C,QAAX,CAAsB,YAA3B,CADJ,cAEI,4BAAM,QAAQ,CAAE,MAAKH,WAArB,eACI,2BAAK,EAAE,CAAC,gBAAR,eACI,oBAAC,MAAD,EACI,KAAK,CAAE,GADX,CAEI,MAAM,CAAE,GAFZ,CAGI,KAAK,CAAE,IAHX,CAII,MAAM,CAAE,MAAKX,MAJjB,CAKI,OAAO,CAAE,MAAKH,OALlB,CAMI,GAAG,CAAE,MAAK3B,KAAL,CAAW6C,WAAX,CAAuBC,GANhC,EADJ,CADJ,cAWI,2BAAK,SAAS,CAAC,YAAf,CAA4B,EAAE,CAAC,eAA/B,eACI,kDADJ,cAEI,6BAAO,IAAI,CAAC,UAAZ,CAAuB,SAAS,CAAG,cAAnC,CAAkD,KAAK,CAAE,MAAK9C,KAAL,CAAWiC,IAAX,CAAgBC,QAAzE,CAAmF,QAAQ,CAAE,MAAKH,gBAAlG,EAFJ,cAGI,6DAHJ,cAII,gCAAU,SAAS,CAAG,cAAtB,CAAqC,KAAK,CAAE,MAAK/B,KAAL,CAAWiC,IAAX,CAAgBK,WAA5D,CAAyE,QAAQ,CAAE,MAAKD,mBAAxF,EAJJ,cAKI,8BAAQ,IAAI,CAAC,QAAb,CACQ,SAAS,CAAG,yBADpB,CAEQ,OAAO,CAAE,MAAKI,WAFtB,eAGI,oBAAC,SAAD,MAHJ,gBALJ,CAXJ,CAFJ,CAAR,CA2BH,CACJ,CA/LiB,OAiMlBM,2BAjMkB,CAiMU,UAAI,CAC5B,GAAG,MAAK/C,KAAL,CAAWC,cAAd,CAA6B,CACzB,mBAAO,8BAAQ,IAAI,CAAC,QAAb,CACC,SAAS,CAAG,yBADb,CAEC,OAAO,CAAE,MAAKF,uBAFf,aAAP,CAKH,CAND,IAMK,CACD,mBAAO,8BAAQ,IAAI,CAAC,QAAb,CACP,SAAS,CAAG,yBADL,CAEP,OAAO,CAAE,MAAKA,uBAFP,SAAP,CAKH,CACJ,CA/MiB,OAiNlBiD,+BAjNkB,CAiNc,UAAI,CACjC,GAAG,MAAKhD,KAAL,CAAWI,kBAAd,CAAiC,CAC5B,mBAAO,8BAAQ,IAAI,CAAC,QAAb,CACC,SAAS,CAAG,yBADb,CAEC,OAAO,CAAE,MAAKD,2BAFf,aAAP,CAKH,CANF,IAMM,CACD,mBAAO,8BAAQ,IAAI,CAAC,QAAb,CACC,SAAS,CAAG,yBADb,CAEC,OAAO,CAAE,MAAKA,2BAFf,SAAP,CAKH,CACJ,CA/NiB,OAiOlB8C,WAjOkB,CAiON,SAAC3C,GAAD,CAAO,CACf,MAAKR,KAAL,CAAWoD,OAAX,CAAmB3B,IAAnB,CAAwB,eAAiBjB,GAAzC,EACH,CAnOiB,CAGd,MAAKN,KAAL,CAAa,CACTmD,GAAG,CAAE,MAAKrD,KAAL,CAAWsD,KAAX,CAAiBC,MAAjB,CAAwBF,GADpB,CAETlB,IAAI,CAAE,EAFG,CAGTY,WAAW,CAAE,CAACC,GAAG,CAAEvD,UAAN,CAHJ,CAIT0B,OAAO,CAAE,EAJA,CAKTO,gBAAgB,CAAC,EALR,CAMTvB,cAAc,CAAE,KANP,CAOTG,kBAAkB,CAAE,KAPX,CAQToC,MAAM,CAAC,KARE,CAAb,CAUA,MAAK1C,KAAL,CAAWoD,OAAX,CAAmB3B,IAAnB,CAAwB,gBAAgB,MAAKzB,KAAL,CAAWsD,KAAX,CAAiBC,MAAjB,CAAwBF,GAAhE,EAEAG,OAAO,CAACC,GAAR,CAAY,MAAKvD,KAAL,CAAWwB,gBAAvB,EAfc,aAgBjB,C,qFAGmB,iBAChB9B,OAAO,CAAC,IAAD,CAAO,UAAI,CACdC,WAAW,CAAC,MAAD,CAAX,CACAC,eAAe,CAAC,MAAD,CAAf,CACH,CAHM,CAAP,CAIH,C,wDAmGegC,C,CAAE,CACdA,CAAC,CAACI,cAAF,GACA,GAAIJ,CAAC,CAAC4B,OAAF,GAAc,EAAlB,CAAqB,CACjB,KAAKxD,KAAL,CAAWiC,IAAX,CAAgBK,WAAhB,CAA8BV,CAAC,CAACO,MAAF,CAASC,KAAT,CAAiB,IAA/C,CACH,EACJ,C,uCAqGO,IACI1B,CAAAA,GADJ,CACY,KAAKZ,KADjB,CACIY,GADJ,CAEJ,mBACI,4CACA,oBAAC,SAAD,EAAW,QAAQ,CAAC,IAApB,eACI,oBAAC,MAAD,EAAQ,GAAG,CAAEA,GAAb,EADJ,CAEK,KAAKiC,gBAAL,CAAsBjC,GAAtB,CAFL,cAKI,2BAAK,EAAE,CAAC,cAAR,eACI,wDACA,yBAAM,2BAAN,MADA,CADJ,cAII,oBAAC,QAAD,EAAU,EAAE,CAAE,KAAKV,KAAL,CAAWC,cAAzB,eACI,2BAAK,SAAS,CAAC,aAAf,eACI,oBAAC,UAAD,EACI,OAAO,CAAE,KAAKD,KAAL,CAAWiB,OADxB,CAEI,UAAU,CAAE,KAAKZ,UAFrB,CAGI,SAAS,CAAE,KAAKoB,SAHpB,CAII,WAAW,CAAI,KAAKwB,WAJxB,CAKI,GAAG,CAAEvC,GALT,EADJ,CADJ,CAJJ,CALJ,CAsBM,KAAKV,KAAL,CAAWC,cAAX,eACE,2BAAK,EAAE,CAAC,0BAAR,eACA,2DACA,yBAAM,+BAAN,MADA,CADA,cAIA,oBAAC,QAAD,EAAU,EAAE,CAAE,KAAKD,KAAL,CAAWI,kBAAzB,eACI,2BAAK,SAAS,CAAC,aAAf,eACI,oBAAC,UAAD,EACI,OAAO,CAAE,KAAKJ,KAAL,CAAWwB,gBADxB,CAEI,UAAU,CAAE,KAAKnB,UAFrB,CAGI,SAAS,CAAE,KAAKoB,SAHpB,CAII,WAAW,CAAI,KAAKwB,WAJxB,CAKI,GAAG,CAAI,KAAKnD,KAAL,CAAWY,GALtB,EADJ,CADJ,CAJA,CAvBR,CAyCM,CAAC,KAAKV,KAAL,CAAWC,cAAZ,eACE,2BAAK,EAAE,CAAC,oBAAR,eACI,2DACA,yBAAM,+BAAN,MADA,CADJ,cAII,oBAAC,QAAD,EAAU,EAAE,CAAE,KAAKD,KAAL,CAAWI,kBAAzB,eACI,2BAAK,SAAS,CAAC,aAAf,eACI,oBAAC,UAAD,EACI,OAAO,CAAE,KAAKJ,KAAL,CAAWwB,gBADxB,CAEI,UAAU,CAAE,KAAKnB,UAFrB,CAGI,SAAS,CAAE,KAAKoB,SAHpB,CAII,WAAW,CAAI,KAAKwB,WAJxB,CAKI,GAAG,CAAI,KAAKnD,KAAL,CAAWY,GALtB,EADJ,CADJ,CAJJ,CA1CR,CADA,CADJ,CAgEH,C,yBAxSoC5B,S,SAApBe,W","sourcesContent":["import React, { Component } from 'react';\nimport Container from \"@material-ui/core/Container\"\nimport './viewProfile.css'\nimport Navbar from \"../Navbar/navbar.component\"\nimport RecipeList from '../recipelist/recipelist.component'\nimport Avatar from 'react-avatar';\nimport {Collapse} from 'react-bootstrap'\nimport {DeleteFromRecipeList, addToRecipeList} from '../../actions/user';\nimport {setRecipe} from '../../actions/recipe'\n\n// hard coded images\nimport ProfilePic from'./default-profile-pic.png' \nimport { FaRegEdit, FaRegSave } from \"react-icons/fa\";\nimport {getUser} from \"../../actions/user\";\nimport {getMyRecipe, getMyCollection} from \"../../actions/recipe\";\n\nexport default class ViewProfile extends Component {\n    constructor(props){\n        super(props);\n        \n        this.state = {\n            uid: this.props.match.params.uid,\n            user: {},\n            userpicture: {src: ProfilePic},\n            recipes: [],\n            collectedRecipes:[],\n            recipeExpanded: false,\n            collectionExpanded: false,\n            inEdit:false\n        }\n        this.props.history.push('/viewprofile/'+this.props.match.params.uid);\n        \n        console.log(this.state.collectedRecipes)\n    }\n\n\n    componentDidMount() {\n        getUser(this, ()=>{\n            getMyRecipe(this);\n            getMyCollection(this);\n        })\n    }\n\n    handleRecipeExpandClick = () => {\n        if(this.state.recipeExpanded){\n            this.setState({ recipeExpanded: false });\n        }else{\n            this.setState({ recipeExpanded: true });\n        }\n    }\n\n    handleCollectionExpandClick= () => {\n        if(this.state.collectionExpanded){\n            this.setState({ collectionExpanded: false });\n        }else{\n            this.setState({ collectionExpanded: true });\n        }\n    }\n\n     clickHeart=(rid)=>{\n        let newLikes = 0;\n        const new_recipes = [];\n        const new_collectedRecipes = [];\n        if(this.props.app.state.currentUser.likedRecipes.includes(rid)){\n            this.props.app.state.currentUser.likedRecipes = this.props.app.state.currentUser.likedRecipes.filter(recipe=> recipe !== rid)\n            DeleteFromRecipeList(this.props.app.state.currentUser._id, {likedRecipes: rid})\n            this.state.recipes.forEach((recipe)=>{\n                const new_recipe = Object.create(recipe)\n                if(recipe._id === rid){\n                    new_recipe.likes--;\n                    newLikes = new_recipe.likes;\n                }\n                new_recipes.push(new_recipe)\n            })\n            this.setState({ recipes: new_recipes });\n\n            this.state.collectedRecipes.forEach((recipe)=>{\n                const new_recipe = Object.create(recipe)\n                if(new_recipe._id === rid){\n                    new_recipe.likes--;\n                }\n                new_collectedRecipes.push(new_recipe)\n            })\n            this.setState({ collectedRecipes: new_collectedRecipes });\n        }else{\n            this.props.app.state.currentUser.likedRecipes.push(rid)\n            addToRecipeList(this.props.app.state.currentUser._id, {likedRecipes: rid})\n            this.state.recipes.forEach((recipe)=>{\n                const new_recipe = Object.create(recipe)\n                if(recipe._id === rid){\n                    new_recipe.likes++;\n                    newLikes = new_recipe.likes;\n                }\n                new_recipes.push(new_recipe)\n            })\n            this.setState({ recipes: new_recipes });\n\n            this.state.collectedRecipes.forEach((recipe)=>{\n                const new_recipe = Object.create(recipe)\n                if(new_recipe._id === rid){\n                    new_recipe.likes++;\n                }\n                new_collectedRecipes.push(new_recipe)\n            })\n            this.setState({ collectedRecipes: new_collectedRecipes });\n        }\n\n        // server call to update recipe\n        setRecipe(rid, {likes: newLikes})\n    }\n\n    clickStar=(rid)=>{\n        if(this.props.app.state.currentUser.collectedRecipes.includes(rid)){\n            this.props.app.state.currentUser.collectedRecipes = this.props.app.state.currentUser.collectedRecipes.filter(recipe=> recipe !== rid)\n            DeleteFromRecipeList(this.props.app.state.currentUser._id, {collectedRecipes: rid})\n        }else{\n            this.props.app.state.currentUser.collectedRecipes.push(rid)\n            addToRecipeList(this.props.app.state.currentUser._id, {collectedRecipes: rid})\n        }\n        this.setState({dummy: 0})\n    }\n\n    onClose=(e)=>{\n        this.setState({preview: null})\n    }\n      \n    onCrop=(e,preview)=>{\n        this.setState({preview})\n    }\n\n    onChangePassword=(e)=>{\n        e.preventDefault();\n        this.state.user.password = e.target.value\n    }\n\n    onChangeDescription=(e)=>{\n        e.preventDefault();\n        this.state.user.description = e.target.value\n    }\n\n    enterKeyHandler(e){\n        e.preventDefault();\n        if (e.keyCode === 13){\n            this.state.user.description = e.target.value + '\\n'\n        };\n    }\n\n    editProfile=(e)=>{\n        e.preventDefault();\n        // this.props.history.push(\"/editprofile/\"+ this.state.uid);\n        this.setState({inEdit: true})\n    }\n\n    saveProfile=(e)=>{\n        e.preventDefault();\n        this.setState({inEdit: false})\n\n    }\n\n    editButtonGenerator=(app)=>{\n        if (app.state.currentUser._id === this.state.user._id){\n            return <button type=\"button\"\n            className = \"btn btn-outline-primary\"\n            onClick={this.editProfile}>\n            <FaRegEdit/>\n            Edit Profile\n            </button>\n        }\n        \n    }\n\n    profileGenerator = (app)=>{\n        if (!this.state.inEdit){\n            return  <div id=\"user-profile\">\n                        <h4>{this.state.user.username + \"'s Profile\"}</h4>\n                        <Avatar id=\"user-picture\" name=\"user\" size=\"150\" round={true} src={this.state.userpicture.src}/> \n                        <div id=\"user-description\">{this.state.user.description}</div>\n                        {this.editButtonGenerator(app)}\n                    </div>\n        } else {\n            return  <div id=\"user-profile\">\n                        <h4>{this.state.username + \"'s Profile\"}</h4>\n                        <form onSubmit={this.saveProfile}>\n                            <div id=\"picture-change\">\n                                <Avatar \n                                    width={200}\n                                    height={200} \n                                    round={true} \n                                    onCrop={this.onCrop}\n                                    onClose={this.onClose}\n                                    src={this.state.userpicture.src}\n                                /> \n                            </div>    \n                            <div className=\"form-group\" id=\"profile-input\">\n                                <div>Change Password:</div>\n                                <input type=\"password\" className = \"form-control\" value={this.state.user.password} onChange={this.onChangePassword}/>\n                                <div>Change Profile Description:</div>\n                                <textarea className = \"form-control\" value={this.state.user.description} onChange={this.onChangeDescription}/>\n                                <button type=\"button\"\n                                        className = \"btn btn-outline-primary\"\n                                        onClick={this.saveProfile}>\n                                    <FaRegSave/>\n                                    Save Profile\n                                </button>    \n                            </div>  \n                        </form>\n                    </div>\n        }\n    }\n\n    RecipeExpandButtonGenerator=()=>{\n        if(this.state.recipeExpanded){\n            return <button type=\"button\"\n                    className = \"btn btn-outline-primary\" \n                    onClick={this.handleRecipeExpandClick}>\n                    Collapse \n                    </button>\n        }else{\n            return <button type=\"button\"\n            className = \"btn btn-outline-primary\" \n            onClick={this.handleRecipeExpandClick}>\n            View \n            </button>\n        }\n    }\n\n    CollectionExpandButtonGenerator=()=>{\n       if(this.state.collectionExpanded){\n            return <button type=\"button\"\n                    className = \"btn btn-outline-primary\" \n                    onClick={this.handleCollectionExpandClick}>\n                    Collapse \n                    </button>\n        }else{\n            return <button type=\"button\"\n                    className = \"btn btn-outline-primary\" \n                    onClick={this.handleCollectionExpandClick}>\n                    View \n                    </button>\n        }\n    }\n\n    clickRecipe=(rid)=>{\n        this.props.history.push(\"/viewrecipe/\" + rid);\n    }\n\n    render(){\n        const { app } = this.props;\n        return(\n            <div>\n            <Container maxWidth='md'>\n                <Navbar app={app}/>\n                {this.profileGenerator(app)}\n                \n                \n                <div id=\"user-recipes\">\n                    <h4>My Recipes\n                    <this.RecipeExpandButtonGenerator/>\n                    </h4>\n                    <Collapse in={this.state.recipeExpanded}>\n                        <div className=\"recipe-list\">\n                            <RecipeList   \n                                recipes={this.state.recipes}\n                                clickHeart={this.clickHeart}\n                                clickStar={this.clickStar}\n                                clickRecipe = {this.clickRecipe}\n                                app={app}\n                            />    \n                        </div>\n                    </Collapse>\n                </div>\n\n                { this.state.recipeExpanded && \n                    <div id=\"collection-recipeswithEx\">\n                    <h4>My Collection\n                    <this.CollectionExpandButtonGenerator/>\n                    </h4>\n                    <Collapse in={this.state.collectionExpanded}>\n                        <div className=\"recipe-list\">\n                            <RecipeList   \n                                recipes={this.state.collectedRecipes}\n                                clickHeart={this.clickHeart}\n                                clickStar={this.clickStar}\n                                clickRecipe = {this.clickRecipe}\n                                app = {this.props.app}\n                            />    \n                        </div>\n                    </Collapse> \n                    </div>\n                }\n\n                { !this.state.recipeExpanded && \n                    <div id=\"collection-recipes\">\n                        <h4>My Collection\n                        <this.CollectionExpandButtonGenerator/>\n                        </h4>\n                        <Collapse in={this.state.collectionExpanded}>\n                            <div className=\"recipe-list\">\n                                <RecipeList   \n                                    recipes={this.state.collectedRecipes}\n                                    clickHeart={this.clickHeart}\n                                    clickStar={this.clickStar}\n                                    clickRecipe = {this.clickRecipe}\n                                    app = {this.props.app}\n                                />    \n                            </div>\n                        </Collapse> \n                    </div>\n                }\n            </Container>\n            </div> \n        )\n    }\n} "]},"metadata":{},"sourceType":"module"}