{"ast":null,"code":"import _regeneratorRuntime from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from\"axios\";export var getMyRecipe=function getMyRecipe(viewProfileComp){var myRecipes=[];console.log(viewProfileComp.state.user);viewProfileComp.state.user.myRecipes.forEach(function(rid){var request=new Request(\"/api/recipes/\".concat(rid),{method:\"get\",headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});fetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){console.log(json);myRecipes.push(json);}).catch(function(error){console.log(error);});});viewProfileComp.setState({recipes:myRecipes});};export var getMyCollection=function getMyCollection(viewProfileComp){var myCollectedRecipes=[];viewProfileComp.state.user.collectedRecipes.forEach(function(rid){var request=new Request(\"/api/recipes/\".concat(rid),{method:\"get\",headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});fetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){console.log(json);myCollectedRecipes.push(json);}).catch(function(error){console.log(error);});});viewProfileComp.setState({collectedRecipes:myCollectedRecipes});};export var addRecipe=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(newRecipeComp){var formData,res,newRecipe;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:formData=new FormData();formData.append('file',newRecipeComp.state.file);_context.prev=2;_context.next=5;return axios.post('/images',formData,{headers:{'Content-Type':'multipart/form-data'}});case 5:res=_context.sent;newRecipe={};newRecipe.creatorId=newRecipeComp.state.creatorId;newRecipe.creatorUsername=newRecipeComp.state.creatorUsername;newRecipe.name=newRecipeComp.state.name;if(newRecipeComp.state.description==null){newRecipe.description=\"none\";}else{newRecipe.description=newRecipeComp.state.description;}newRecipe.categories=newRecipeComp.state.categories;newRecipe.ingredients=newRecipeComp.state.ingredients;newRecipe.steps=newRecipeComp.state.steps;newRecipe.imageUrl=res.data.imageUrl;newRecipe.imageId=res.data.imageId;axios.post('/api/recipes/',newRecipe);console.log(newRecipe);alert(\"The Recipe has been succesfully created!\");newRecipeComp.props.history.push(\"/viewprofile/\"+newRecipeComp.props.app.state.currentUser._id);_context.next=25;break;case 22:_context.prev=22;_context.t0=_context[\"catch\"](2);if(_context.t0.response.status===500){console.log('There was a problem with the server');}else{console.log(_context.t0);}case 25:case\"end\":return _context.stop();}}},_callee,null,[[2,22]]);}));return function addRecipe(_x){return _ref.apply(this,arguments);};}();export var getRecipe=function getRecipe(comp,rid){var request=new Request(\"/api/recipes/\".concat(rid),{method:\"get\",headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});fetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){console.log(json);comp.setState({recipe:json});}).catch(function(error){console.log(error);});};export var deleteRecipe=function deleteRecipe(rid,deleteComp){var request=new Request(\"/api/recipes/\".concat(rid),{method:\"delete\",headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});fetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){deleteComp.props.history.push(\"/viewprofile/\"+deleteComp.props.app.state.currentUser._id);}).catch(function(error){console.log(error);});};export var getAllRecipes=function getAllRecipes(comp){var request=new Request(\"/api/recipes\",{method:\"get\",headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});fetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){console.log(json);comp.setState({recipes:json.recipes});comp.setState({displayed_recipes:json.recipes});// update top three recipes\nvar first_largest=-1;var second_largest=-1;var third_largest=-1;var first_idx=-1;var second_idx=-1;var third_idx=-1;for(var i=0;i<json.recipes.length;i++){if(json.recipes[i].likes>=first_largest){third_largest=second_largest;second_largest=first_largest;first_largest=json.recipes[i].likes;third_idx=second_idx;second_idx=first_idx;first_idx=i;}else if(json.recipes[i].likes>=second_largest){third_largest=second_largest;second_largest=json.recipes[i].likes;third_idx=second_idx;second_idx=i;}else if(json.recipes[i].likes>=third_largest){third_largest=json.recipes[i].likes;third_idx=i;}}comp.setState({top3_recipe:[first_idx,second_idx,third_idx]});}).catch(function(error){console.log(error);});};export var getTop2Recipes=function getTop2Recipes(comp,rid){var request=new Request(\"/api/recipes\",{method:\"get\",headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});fetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){console.log(json);comp.setState({recipes:json.recipes});comp.setState({displayed_recipes:json.recipes});comp.setState({top2_recipes:[]});// update top 2 recipes\nvar first_largest=-1;var second_largest=-1;var first_recipe={};var second_recipe={};for(var i=0;i<json.recipes.length;i++){if(json.recipes[i]._id===rid){continue;}else if(json.recipes[i].likes>=first_largest){second_largest=first_largest;first_largest=json.recipes[i].likes;second_recipe=first_recipe;first_recipe=json.recipes[i];}else if(json.recipes[i].likes>=second_largest){second_largest=json.recipes[i].likes;second_recipe=json.recipes[i];}}console.log([first_recipe,second_recipe]);comp.setState({top2_recipes:[first_recipe,second_recipe]});}).catch(function(error){console.log(error);});};// set a recipe field \nexport var setRecipe=function setRecipe(rid,newRecipe){axios.patch(\"/api/recipes/\".concat(rid),newRecipe).then(function(res){return console.log(res.data);});};","map":{"version":3,"sources":["/Users/FrankChen/csc309/tp/team07/client/src/actions/recipe.js"],"names":["axios","getMyRecipe","viewProfileComp","myRecipes","console","log","state","user","forEach","rid","request","Request","method","headers","Accept","fetch","then","res","status","json","push","catch","error","setState","recipes","getMyCollection","myCollectedRecipes","collectedRecipes","addRecipe","newRecipeComp","formData","FormData","append","file","post","newRecipe","creatorId","creatorUsername","name","description","categories","ingredients","steps","imageUrl","data","imageId","alert","props","history","app","currentUser","_id","response","getRecipe","comp","recipe","deleteRecipe","deleteComp","getAllRecipes","displayed_recipes","first_largest","second_largest","third_largest","first_idx","second_idx","third_idx","i","length","likes","top3_recipe","getTop2Recipes","top2_recipes","first_recipe","second_recipe","setRecipe","patch"],"mappings":"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","sourcesContent":["import axios from \"axios\";\n\nexport const getMyRecipe = (viewProfileComp) => {\n    const myRecipes = []\n    console.log(viewProfileComp.state.user)\n    viewProfileComp.state.user.myRecipes.forEach(rid => {\n        const request = new Request(`/api/recipes/${rid}`, {\n            method: \"get\",\n            headers: {\n                Accept: \"application/json, text/plain, */*\",\n                \"Content-Type\": \"application/json\"\n            }\n        })\n    \n        fetch(request)\n            .then(res=>{\n                if(res.status === 200){\n                    return res.json();\n                }\n            })\n            .then(json=>{\n                console.log(json)\n                myRecipes.push(json)\n            })\n            .catch(error=>{\n                console.log(error);\n            })\n        \n    });\n    viewProfileComp.setState({recipes: myRecipes})  \n}\n\nexport const getMyCollection = (viewProfileComp) => {\n    const myCollectedRecipes = []\n    viewProfileComp.state.user.collectedRecipes.forEach(rid => {\n        const request = new Request(`/api/recipes/${rid}`, {\n            method: \"get\",\n            headers: {\n                Accept: \"application/json, text/plain, */*\",\n                \"Content-Type\": \"application/json\"\n            }\n        })\n    \n        fetch(request)\n            .then(res=>{\n                if(res.status === 200){\n                    return res.json();\n                }\n            })\n            .then(json=>{\n                console.log(json)\n                myCollectedRecipes.push(json)\n            })\n            .catch(error=>{\n                console.log(error);\n            })\n        \n    });\n    viewProfileComp.setState({collectedRecipes: myCollectedRecipes})\n}\n\n\nexport const addRecipe = async(newRecipeComp) => {\n    const formData = new FormData();   \n    formData.append('file', newRecipeComp.state.file);\n\n    try{\n        const res = await axios.post('/images', formData, {\n            headers: {\n                'Content-Type': 'multipart/form-data'\n            }\n        })\n\n        const newRecipe = {};\n        newRecipe.creatorId = newRecipeComp.state.creatorId;\n        newRecipe.creatorUsername = newRecipeComp.state.creatorUsername;\n        newRecipe.name = newRecipeComp.state.name;\n        if(newRecipeComp.state.description == null){\n            newRecipe.description = \"none\";\n        }else{\n            newRecipe.description = newRecipeComp.state.description;\n        }\n        newRecipe.categories = newRecipeComp.state.categories;\n        newRecipe.ingredients = newRecipeComp.state.ingredients;\n        newRecipe.steps = newRecipeComp.state.steps;\n        newRecipe.imageUrl = res.data.imageUrl;\n        newRecipe.imageId = res.data.imageId;\n\n        axios.post('/api/recipes/', newRecipe);\n        console.log(newRecipe)\n        alert(\"The Recipe has been succesfully created!\")\n        newRecipeComp.props.history.push(\"/viewprofile/\"+ newRecipeComp.props.app.state.currentUser._id)\n    } catch(error) {\n        if(error.response.status === 500){\n            console.log('There was a problem with the server')\n        } else{\n            console.log(error)\n        }\n    }\n   \n}\n\nexport const getRecipe = (comp, rid) => {\n    const request = new Request(`/api/recipes/${rid}`, {\n        method: \"get\",\n        headers: {\n            Accept: \"application/json, text/plain, */*\",\n            \"Content-Type\": \"application/json\"\n        }\n    })\n\n    fetch(request)\n        .then(res=>{\n            if(res.status === 200){\n                return res.json();\n            }\n        })\n        .then(json=>{\n            console.log(json)\n            comp.setState({recipe: json})\n        })\n        .catch(error=>{\n            console.log(error);\n        })\n}\n\nexport const deleteRecipe = (rid, deleteComp) => {\n    const request = new Request(`/api/recipes/${rid}`, {\n        method: \"delete\",\n        headers: {\n            Accept: \"application/json, text/plain, */*\",\n            \"Content-Type\": \"application/json\"\n        }\n    })\n\n    fetch(request)\n        .then(res=>{\n            if(res.status === 200){\n                return res.json();\n            }\n        })\n        .then(json=>{\n            deleteComp.props.history.push(\"/viewprofile/\"+ deleteComp.props.app.state.currentUser._id)\n        })\n        .catch(error=>{\n            console.log(error);\n        })\n}\n\nexport const getAllRecipes = (comp)=>{\n    const request = new Request(`/api/recipes`, {\n        method: \"get\",\n        headers: {\n            Accept: \"application/json, text/plain, */*\",\n            \"Content-Type\": \"application/json\"\n        }\n    })\n\n    fetch(request)\n        .then(res=>{\n            if(res.status === 200){\n                return res.json();\n            }\n        })\n        .then(json=>{\n            console.log(json)\n            comp.setState({recipes: json.recipes})\n            comp.setState({displayed_recipes: json.recipes})\n            \n            // update top three recipes\n            let first_largest = -1;\n            let second_largest = -1;\n            let third_largest = -1;\n            let first_idx = -1;\n            let second_idx = -1;\n            let third_idx = -1;\n            for(let i=0; i< json.recipes.length; i++){\n                if(json.recipes[i].likes >= first_largest){\n                    third_largest = second_largest;\n                    second_largest = first_largest;\n                    first_largest = json.recipes[i].likes;\n                    third_idx = second_idx;\n                    second_idx = first_idx;\n                    first_idx = i;\n                }else if(json.recipes[i].likes >= second_largest){\n                    third_largest = second_largest;\n                    second_largest = json.recipes[i].likes;\n                    third_idx = second_idx;\n                    second_idx = i;\n                }else if(json.recipes[i].likes >= third_largest){\n                    third_largest = json.recipes[i].likes;\n                    third_idx = i;\n                }\n            }\n            comp.setState({ top3_recipe: [first_idx, second_idx, third_idx]})\n        })\n        .catch(error=>{\n            console.log(error);\n        })\n}\n\nexport const getTop2Recipes = (comp, rid)=>{\n    const request = new Request(`/api/recipes`, {\n        method: \"get\",\n        headers: {\n            Accept: \"application/json, text/plain, */*\",\n            \"Content-Type\": \"application/json\"\n        }\n    })\n\n    fetch(request)\n        .then(res=>{\n            if(res.status === 200){\n                return res.json();\n            }\n        })\n        .then(json=>{\n            console.log(json)\n            comp.setState({recipes: json.recipes})\n            comp.setState({displayed_recipes: json.recipes})\n            comp.setState({ top2_recipes: []})\n            // update top 2 recipes\n            let first_largest = -1;\n            let second_largest = -1;\n            let first_recipe = {};\n            let second_recipe = {};\n            for(let i=0; i< json.recipes.length; i++){\n                if(json.recipes[i]._id === rid){\n                    continue;\n                }else if(json.recipes[i].likes >= first_largest){\n                    second_largest = first_largest;\n                    first_largest = json.recipes[i].likes;\n                    second_recipe = first_recipe;\n                    first_recipe = json.recipes[i];\n                }else if(json.recipes[i].likes >= second_largest){\n                    second_largest = json.recipes[i].likes;\n                    second_recipe = json.recipes[i];\n                }\n            }\n            console.log([first_recipe, second_recipe])\n            comp.setState({ top2_recipes: [first_recipe, second_recipe]})\n        })\n        .catch(error=>{\n            console.log(error);\n        })\n}\n\n// set a recipe field \nexport const setRecipe = (rid, newRecipe) => {\n    axios.patch(`/api/recipes/${rid}`, newRecipe)\n    .then(res => console.log(res.data));\n}\n"]},"metadata":{},"sourceType":"module"}