{"ast":null,"code":"import _objectWithoutProperties from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _regeneratorRuntime from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Container,AppBar,Tabs,Tab,Box}from\"@material-ui/core\";import'./viewProfile.css';import Navbar from\"../Navbar/navbar.component\";import RecipeList from'../recipelist/recipelist.component';import Avatar from'react-avatar-edit';import{Collapse}from'react-bootstrap';import{DeleteFromRecipeList,addToRecipeList}from'../../actions/recipe';import{setRecipe}from'../../actions/recipe';import{withStyles}from'@material-ui/core/styles';// hard coded images\nimport defaultPic from'./default-profile-pic.png';import{FaRegEdit,FaRegSave}from\"react-icons/fa\";import{getUser,updateUser}from\"../../actions/user\";import{getMyRecipe,getMyCollection}from\"../../actions/recipe\";var styles={panel:{backgroundColor:\"white\",marginTop:20,borderRadius:10},scrollButtons:{color:\"black\",backgroundColor:\"darkgray\"},indicator:{backgroundColor:\"darkgray\"},bar:{backgroundColor:\"white\",borderRadius:5},flexContainer:{color:\"darkgray\",borderRadius:20},tab:{color:\"black\"}};var ViewProfile=/*#__PURE__*/function(_Component){_inherits(ViewProfile,_Component);var _super=_createSuper(ViewProfile);function ViewProfile(_props){var _this;_classCallCheck(this,ViewProfile);_this=_super.call(this,_props);_this.clickHeart=function(rid){var newLikes=0;var new_recipes=[];var new_collectedRecipes=[];if(_this.props.app.state.currentUser.likedRecipes.includes(rid)){_this.props.app.state.currentUser.likedRecipes=_this.props.app.state.currentUser.likedRecipes.filter(function(recipe){return recipe!==rid;});DeleteFromRecipeList(_this.props.app.state.currentUser._id,{likedRecipes:rid});_this.state.recipes.forEach(function(recipe){var new_recipe=Object.create(recipe);if(recipe._id===rid){new_recipe.likes--;newLikes=new_recipe.likes;}new_recipes.push(new_recipe);});_this.setState({recipes:new_recipes});_this.state.collectedRecipes.forEach(function(recipe){var new_recipe=Object.create(recipe);if(new_recipe._id===rid){new_recipe.likes--;}new_collectedRecipes.push(new_recipe);});_this.setState({collectedRecipes:new_collectedRecipes});}else{_this.props.app.state.currentUser.likedRecipes.push(rid);addToRecipeList(_this.props.app.state.currentUser._id,{likedRecipes:rid});_this.state.recipes.forEach(function(recipe){var new_recipe=Object.create(recipe);if(recipe._id===rid){new_recipe.likes++;newLikes=new_recipe.likes;}new_recipes.push(new_recipe);});_this.setState({recipes:new_recipes});_this.state.collectedRecipes.forEach(function(recipe){var new_recipe=Object.create(recipe);if(new_recipe._id===rid){new_recipe.likes++;}new_collectedRecipes.push(new_recipe);});_this.setState({collectedRecipes:new_collectedRecipes});}// server call to update recipe\nsetRecipe(rid,{likes:newLikes});};_this.clickStar=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(rid){var new_collectedRecipes,added_id;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!_this.props.app.state.currentUser.collectedRecipes.includes(rid)){_context.next=6;break;}_this.props.app.state.currentUser.collectedRecipes=_this.props.app.state.currentUser.collectedRecipes.filter(function(recipe){return recipe!==rid;});_context.next=4;return DeleteFromRecipeList(_this.props.app.state.currentUser._id,{collectedRecipes:rid});case 4:_context.next=9;break;case 6:_this.props.app.state.currentUser.collectedRecipes.push(rid);_context.next=9;return addToRecipeList(_this.props.app.state.currentUser._id,{collectedRecipes:rid});case 9:new_collectedRecipes=[];added_id=[];_this.state.collectedRecipes.forEach(function(recipe){var new_recipe=Object.create(recipe);if(_this.props.app.state.currentUser.collectedRecipes.includes(new_recipe._id)){added_id.push(new_recipe._id);new_collectedRecipes.push(new_recipe);}});_this.state.recipes.forEach(function(recipe){var new_recipe=Object.create(recipe);if(_this.props.app.state.currentUser.collectedRecipes.includes(new_recipe._id)&&!added_id.includes(new_recipe._id)){new_collectedRecipes.push(new_recipe);}});_this.setState({collectedRecipes:new_collectedRecipes});case 14:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.onClose=function(){_this.setState({profilePic:null});};_this.onCrop=function(preview){var img=new Blob([preview],{type:\"image/png\"});_this.setState({profilePic:img});console.log(_this.state.profilePic);};_this.onImageLoad=function(img){_this.setState({profilePic:img});console.log(img);};_this.onChangePassword=function(e){e.preventDefault();_this.setState({newPassword:e.target.value});};_this.onChangeDescription=function(e){e.preventDefault();var newUser=_this.state.user;newUser.description=e.target.value;_this.setState({user:newUser});};_this.editProfile=function(e){e.preventDefault();_this.setState({inEdit:true});};_this.saveProfile=function(e){e.preventDefault();var updateInfo={description:_this.state.user.description,profilePic:_this.state.profilePic};if(_this.state.newPassword!==null&&_this.state.newPassword!==\"\"){if(_this.state.newPassword.length<4){alert(\"Password needs a minimum length of 4\");return;}else{updateInfo.password=_this.state.newPassword;_this.setState({password:_this.state.newPassword});_this.setState({newPassword:null});}}console.log(updateInfo);updateUser(_assertThisInitialized(_this),updateInfo,function(comp){comp.setState({inEdit:false});});};_this.editButtonGenerator=function(app){if(app.state.currentUser._id===_this.state.user._id){return/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-primary\",onClick:_this.editProfile},/*#__PURE__*/React.createElement(FaRegEdit,null),\"  Edit Profile\");}};_this.profileGenerator=function(app){if(!_this.state.inEdit){return/*#__PURE__*/React.createElement(\"div\",{id:\"user-profile\"},/*#__PURE__*/React.createElement(\"h4\",null,_this.state.user.username+\"'s Profile\"),/*#__PURE__*/React.createElement(\"div\",{id:\"profile-pic\"},/*#__PURE__*/React.createElement(\"img\",{alt:_this.state.user.imageUrl,src:_this.state.user.imageUrl?_this.state.user.imageUrl:defaultPic,style:{width:\"inherit\",height:\"inherit\"}})),/*#__PURE__*/React.createElement(\"div\",{id:\"user-description\"},_this.state.user.description),_this.editButtonGenerator(app));}else{return/*#__PURE__*/React.createElement(\"div\",{id:\"user-profile\"},/*#__PURE__*/React.createElement(\"h4\",null,_this.state.user.username+\"'s Profile\"),/*#__PURE__*/React.createElement(\"form\",{className:\"signup-form\",onSubmit:_this.saveProfile},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\",id:\"change-pic\"},/*#__PURE__*/React.createElement(Avatar,{width:250,height:250,round:true,label:\"Change profile picture\",onFileLoad:_this.onImageLoad,onCrop:_this.onCrop,onClose:_this.onClose})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\",id:\"profile-input\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\" New Password: \"),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",className:\"form-control\",onChange:_this.onChangePassword})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Edit your Description: \"),/*#__PURE__*/React.createElement(\"textarea\",{className:\"form-control\",value:_this.state.user.description,onChange:_this.onChangeDescription})),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-outline-primary save-button\",onClick:_this.saveProfile},/*#__PURE__*/React.createElement(FaRegSave,null),\"Save Profile\"))));}};_this.clickRecipe=function(rid){_this.props.history.push(\"/viewrecipe/\"+rid);};_this.TabPanel=function(props){var children=props.children,value=props.value,index=props.index,other=_objectWithoutProperties(props,[\"children\",\"value\",\"index\"]);return/*#__PURE__*/React.createElement(\"div\",other,value===index&&/*#__PURE__*/React.createElement(Box,{p:3},children));};_this.handleTab=function(event,newTab){_this.setState({currTab:newTab});};_this.state={uid:_this.props.match.params.uid,user:{},profilePic:null,recipes:[],collectedRecipes:[],newPassword:null,inEdit:false,preview:null,currTab:-1};_this.props.history.push('/viewprofile/'+_this.props.match.params.uid);getUser(_assertThisInitialized(_this),function(){getMyRecipe(_assertThisInitialized(_this));getMyCollection(_assertThisInitialized(_this));});console.log(_this.state.collectedRecipes);return _this;}_createClass(ViewProfile,[{key:\"render\",value:function render(){var _this$props=this.props,app=_this$props.app,classes=_this$props.classes;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Container,{maxWidth:\"md\"},/*#__PURE__*/React.createElement(Navbar,{app:app}),this.profileGenerator(app),/*#__PURE__*/React.createElement(\"div\",{id:\"recipe-div\"},/*#__PURE__*/React.createElement(AppBar,{position:\"static\",className:classes.bar,color:\"white\"},/*#__PURE__*/React.createElement(Tabs,{value:this.state.currTab,onChange:this.handleTab,variant:\"fullWidth\",classes:{indicator:classes.indicator,flexContainer:classes.flexContainer}},/*#__PURE__*/React.createElement(Tab,{label:\"My Recipes\",className:classes.tab}),/*#__PURE__*/React.createElement(Tab,{label:\"My Collection\",className:classes.tab}))),/*#__PURE__*/React.createElement(this.TabPanel,{className:classes.panel,value:this.state.currTab,index:0},/*#__PURE__*/React.createElement(RecipeList,{recipes:this.state.recipes,clickHeart:this.clickHeart,clickStar:this.clickStar,clickRecipe:this.clickRecipe,app:app})),/*#__PURE__*/React.createElement(this.TabPanel,{className:classes.panel,value:this.state.currTab,index:1},/*#__PURE__*/React.createElement(RecipeList,{recipes:this.state.collectedRecipes,clickHeart:this.clickHeart,clickStar:this.clickStar,clickRecipe:this.clickRecipe,app:app})))));}}]);return ViewProfile;}(Component);export default withStyles(styles)(ViewProfile);","map":{"version":3,"sources":["/Users/FrankChen/csc309/tp/team07/client/src/components/viewProfile/viewProfile.component.js"],"names":["React","Component","Container","AppBar","Tabs","Tab","Box","Navbar","RecipeList","Avatar","Collapse","DeleteFromRecipeList","addToRecipeList","setRecipe","withStyles","defaultPic","FaRegEdit","FaRegSave","getUser","updateUser","getMyRecipe","getMyCollection","styles","panel","backgroundColor","marginTop","borderRadius","scrollButtons","color","indicator","bar","flexContainer","tab","ViewProfile","props","clickHeart","rid","newLikes","new_recipes","new_collectedRecipes","app","state","currentUser","likedRecipes","includes","filter","recipe","_id","recipes","forEach","new_recipe","Object","create","likes","push","setState","collectedRecipes","clickStar","added_id","onClose","profilePic","onCrop","preview","img","Blob","type","console","log","onImageLoad","onChangePassword","e","preventDefault","newPassword","target","value","onChangeDescription","newUser","user","description","editProfile","inEdit","saveProfile","updateInfo","length","alert","password","comp","editButtonGenerator","profileGenerator","username","imageUrl","width","height","clickRecipe","history","TabPanel","children","index","other","handleTab","event","newTab","currTab","uid","match","params","classes"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {Container, AppBar, Tabs, Tab, Box} from \"@material-ui/core\"\nimport './viewProfile.css'\nimport Navbar from \"../Navbar/navbar.component\"\nimport RecipeList from '../recipelist/recipelist.component'\nimport Avatar from 'react-avatar-edit';\nimport {Collapse} from 'react-bootstrap'\nimport {DeleteFromRecipeList, addToRecipeList} from '../../actions/recipe';\nimport {setRecipe} from '../../actions/recipe'\nimport { withStyles } from '@material-ui/core/styles';\n\n// hard coded images\nimport defaultPic from'./default-profile-pic.png' \nimport { FaRegEdit, FaRegSave } from \"react-icons/fa\";\nimport {getUser, updateUser} from \"../../actions/user\";\nimport {getMyRecipe, getMyCollection} from \"../../actions/recipe\";\n\nconst styles = {\n    panel: {\n        backgroundColor: \"white\",\n        marginTop: 20,\n        borderRadius:10\n    },\n    scrollButtons: {\n        color: \"black\",\n        backgroundColor: \"darkgray\"\n    },\n\n    indicator: {\n        backgroundColor: \"darkgray\"\n    },\n\n    bar: {\n        backgroundColor: \"white\",\n        borderRadius: 5,\n\n    },\n\n    flexContainer: {\n        color: \"darkgray\",\n        borderRadius: 20,\n    },\n    tab: {\n        color: \"black\"\n    }\n\n}\nclass ViewProfile extends Component {\n    constructor(props){\n        super(props);\n        \n        this.state = {\n            uid: this.props.match.params.uid,\n            user: {},\n            profilePic: null,\n            recipes: [],\n            collectedRecipes:[],\n            newPassword: null,\n            inEdit:false,\n            preview:null,\n            currTab:-1,\n        }\n        this.props.history.push('/viewprofile/'+this.props.match.params.uid);\n        getUser(this, ()=>{\n            getMyRecipe(this);\n            getMyCollection(this);\n        })\n        console.log(this.state.collectedRecipes)\n    }\n\n\n \n\n   \n\n     clickHeart=(rid)=>{\n        let newLikes = 0;\n        const new_recipes = [];\n        const new_collectedRecipes = [];\n        if(this.props.app.state.currentUser.likedRecipes.includes(rid)){\n            this.props.app.state.currentUser.likedRecipes = this.props.app.state.currentUser.likedRecipes.filter(recipe=> recipe !== rid)\n            DeleteFromRecipeList(this.props.app.state.currentUser._id, {likedRecipes: rid})\n            this.state.recipes.forEach((recipe)=>{\n                const new_recipe = Object.create(recipe)\n                if(recipe._id === rid){\n                    new_recipe.likes--;\n                    newLikes = new_recipe.likes;\n                }\n                new_recipes.push(new_recipe)\n            })\n            this.setState({ recipes: new_recipes });\n\n            this.state.collectedRecipes.forEach((recipe)=>{\n                const new_recipe = Object.create(recipe)\n                if(new_recipe._id === rid){\n                    new_recipe.likes--;\n                }\n                new_collectedRecipes.push(new_recipe)\n            })\n            this.setState({ collectedRecipes: new_collectedRecipes });\n        }else{\n            this.props.app.state.currentUser.likedRecipes.push(rid)\n            addToRecipeList(this.props.app.state.currentUser._id, {likedRecipes: rid})\n            this.state.recipes.forEach((recipe)=>{\n                const new_recipe = Object.create(recipe)\n                if(recipe._id === rid){\n                    new_recipe.likes++;\n                    newLikes = new_recipe.likes;\n                }\n                new_recipes.push(new_recipe)\n            })\n            this.setState({ recipes: new_recipes });\n\n            this.state.collectedRecipes.forEach((recipe)=>{\n                const new_recipe = Object.create(recipe)\n                if(new_recipe._id === rid){\n                    new_recipe.likes++;\n                }\n                new_collectedRecipes.push(new_recipe)\n            })\n            this.setState({ collectedRecipes: new_collectedRecipes });\n        }\n\n        // server call to update recipe\n        setRecipe(rid, {likes: newLikes})\n    }\n\n    clickStar=async(rid)=>{\n        if(this.props.app.state.currentUser.collectedRecipes.includes(rid)){\n            this.props.app.state.currentUser.collectedRecipes = this.props.app.state.currentUser.collectedRecipes.filter(recipe=> recipe !== rid)\n            await DeleteFromRecipeList(this.props.app.state.currentUser._id, {collectedRecipes: rid})\n        }else{\n            this.props.app.state.currentUser.collectedRecipes.push(rid)\n            await addToRecipeList(this.props.app.state.currentUser._id, {collectedRecipes: rid})\n        }\n\n        let new_collectedRecipes = [];\n        let added_id = [];\n        this.state.collectedRecipes.forEach((recipe)=>{\n            const new_recipe = Object.create(recipe)\n            if(this.props.app.state.currentUser.collectedRecipes.includes(new_recipe._id)){\n                added_id.push(new_recipe._id)\n                new_collectedRecipes.push(new_recipe)\n            }\n        })\n        this.state.recipes.forEach((recipe)=>{\n            const new_recipe = Object.create(recipe)\n            if(this.props.app.state.currentUser.collectedRecipes.includes(new_recipe._id) && !added_id.includes(new_recipe._id)){\n                new_collectedRecipes.push(new_recipe)\n            }\n        })\n        this.setState({ collectedRecipes: new_collectedRecipes });\n    }\n\n    onClose=()=>{\n        this.setState({profilePic: null})\n    }\n      \n    onCrop=(preview)=>{\n        const img = new Blob([preview], {type: \"image/png\"})\n        this.setState({profilePic: img})\n        console.log(this.state.profilePic)\n    }\n\n    onImageLoad=(img)=>{\n        this.setState({profilePic: img});\n        console.log(img)\n    }\n\n    onChangePassword=(e)=>{\n        e.preventDefault();\n        this.setState({newPassword: e.target.value})\n    }\n\n    onChangeDescription=(e)=>{\n        e.preventDefault();\n        const newUser = this.state.user\n        newUser.description = e.target.value\n        this.setState({user: newUser})\n    }\n\n    editProfile=(e)=>{\n        e.preventDefault();\n        this.setState({inEdit: true})\n    }\n\n    saveProfile=(e)=>{\n        e.preventDefault();\n        const updateInfo = {\n            description: this.state.user.description,\n            profilePic: this.state.profilePic\n        }\n        \n        if (this.state.newPassword !== null && this.state.newPassword !== \"\"){\n            if (this.state.newPassword.length < 4){\n                alert(\"Password needs a minimum length of 4\")\n                return\n            } else{\n                updateInfo.password = this.state.newPassword\n                this.setState({password: this.state.newPassword})\n                this.setState({newPassword: null})\n            }\n        }\n        \n        console.log(updateInfo)\n        updateUser(this, updateInfo, (comp)=>{\n            comp.setState({inEdit:false})\n        }) \n    }\n\n    editButtonGenerator=(app)=>{\n        if (app.state.currentUser._id === this.state.user._id){\n            return <button type=\"button\"\n            className = \"btn btn-outline-primary\"\n            onClick={this.editProfile}>\n            <FaRegEdit/>\n            {\"  Edit Profile\"}\n            </button>\n        }\n        \n    }\n\n    profileGenerator = (app)=>{\n        if (!this.state.inEdit){\n            return  <div id=\"user-profile\">\n                        <h4>{this.state.user.username + \"'s Profile\"}</h4>\n                        <div id=\"profile-pic\">\n                            <img alt={this.state.user.imageUrl} src={this.state.user.imageUrl ? this.state.user.imageUrl : defaultPic}\n                                style={{width:\"inherit\",  height:\"inherit\"}}/> \n                        </div>\n                        <div id=\"user-description\">{this.state.user.description}</div>\n                        {this.editButtonGenerator(app)}\n                    </div>\n        } else {\n            return  <div id=\"user-profile\">\n                        <h4>{this.state.user.username + \"'s Profile\"}</h4>\n                        <form className=\"signup-form\" onSubmit={this.saveProfile}>\n                            <div className=\"form-group\" id=\"change-pic\">\n                                <Avatar \n                                    width={250}\n                                    height={250} \n                                    round={true}\n                                    label={\"Change profile picture\"}\n                                    onFileLoad={this.onImageLoad}\n                                    onCrop={this.onCrop}\n                                    onClose={this.onClose}\n                                /> \n                            </div>    \n                            <div className=\"form-group\" id=\"profile-input\">\n                                <div className=\"form-group\">\n                                    <label> New Password: </label>\n                                    <input type=\"password\" className = \"form-control\" onChange={this.onChangePassword}/>\n                                </div>\n                                <div className=\"form-group\">\n                                    <label>Edit your Description: </label>\n                                    <textarea className = \"form-control\" value={this.state.user.description} onChange={this.onChangeDescription}/>\n                                </div>\n                                <button type=\"button\"\n                                        className = \"btn btn-outline-primary save-button\"\n                                        onClick={this.saveProfile}>\n                                    <FaRegSave/>\n                                    Save Profile\n                                </button>    \n                            </div>  \n                        </form>\n                    </div>\n        }\n    }\n\n\n  \n\n    clickRecipe=(rid)=>{\n        this.props.history.push(\"/viewrecipe/\" + rid);\n    }\n\n    TabPanel = (props) => {\n        const { children, value, index, ...other } = props;\n        return (\n          <div {...other}>\n            {value === index && <Box p={3}>{children}</Box>}\n          </div>\n        );\n    }\n\n    handleTab = (event, newTab) => {\n        this.setState({currTab: newTab});\n    };\n\n    render(){\n        const { app, classes} = this.props;\n\n        return(\n            <div>\n            <Container maxWidth='md'>\n                <Navbar app={app}/>\n                {this.profileGenerator(app)}\n                \n                <div id=\"recipe-div\">\n                    <AppBar position=\"static\" className={classes.bar} color=\"white\">\n                        <Tabs value={this.state.currTab} onChange={this.handleTab} variant=\"fullWidth\" classes={{\n    indicator: classes.indicator, flexContainer: classes.flexContainer\n  }}>\n                        <Tab label=\"My Recipes\" className={classes.tab}/>\n                        <Tab label=\"My Collection\" className={classes.tab}/>\n                        </Tabs>\n                    </AppBar>\n                    <this.TabPanel className={classes.panel} value={this.state.currTab} index={0}>\n                        <RecipeList   \n                            recipes={this.state.recipes}\n                            clickHeart={this.clickHeart}\n                            clickStar={this.clickStar}\n                            clickRecipe = {this.clickRecipe}\n                            app={app}\n                        />\n                    </this.TabPanel>\n                    <this.TabPanel className={classes.panel} value={this.state.currTab} index={1}>\n\n                        <RecipeList   \n                            recipes={this.state.collectedRecipes}\n                            clickHeart={this.clickHeart}\n                            clickStar={this.clickStar}\n                            clickRecipe = {this.clickRecipe}\n                            app={app}\n                        />\n                    </this.TabPanel>\n\n                </div>\n                \n            </Container>\n            </div> \n        )\n    }\n} \n\n\nexport default withStyles(styles)(ViewProfile);"]},"metadata":{},"sourceType":"module"}