{"ast":null,"code":"import _regeneratorRuntime from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/FrankChen/csc309/tp/team07/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from\"axios\";// modify recipe list of the user\n/*\nadd a new recipe to recipe lists\n{\n    \"likedRecipes\": <rid>,\n    \"collectedRecipes\": <rid>,\n    \"myRecipes\": <rid>\n}\n*/export var addToRecipeList=function addToRecipeList(uid,recipeList){// create our request constructor with all the parameters we need\nvar request=new Request(\"/api/users/\".concat(uid),{method:\"post\",body:JSON.stringify(recipeList),headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});console.log(request);// send the request with fetch()\nfetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){console.log(json);}).catch(function(error){console.log(error);});};/*\ndelete a new recipe to recipe lists\n{\n    \"likedRecipes\": <rid>,\n    \"collectedRecipes\": <rid>,\n    \"myRecipes\": <rid>\n}\n*/export var DeleteFromRecipeList=function DeleteFromRecipeList(uid,recipeList){// create our request constructor with all the parameters we need\nvar request=new Request(\"/api/users/\".concat(uid),{method:\"delete\",body:JSON.stringify(recipeList),headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});// send the request with fetch()\nfetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){console.log(json);}).catch(function(error){console.log(error);});};export var getMyRecipe=function getMyRecipe(viewProfileComp){var myRecipes=[];console.log(viewProfileComp.state.user);viewProfileComp.state.user.myRecipes.forEach(function(rid){var request=new Request(\"/api/recipes/\".concat(rid),{method:\"get\",headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});fetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){if(json){console.log(json);myRecipes.push(json);}}).catch(function(error){console.log(error);});});viewProfileComp.setState({recipes:myRecipes});};export var getMyCollection=function getMyCollection(viewProfileComp){var myCollectedRecipes=[];viewProfileComp.state.user.collectedRecipes.forEach(function(rid){var request=new Request(\"/api/recipes/\".concat(rid),{method:\"get\",headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});fetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){console.log(json);myCollectedRecipes.push(json);}).catch(function(error){console.log(error);});});viewProfileComp.setState({collectedRecipes:myCollectedRecipes});};export var addRecipe=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(newRecipeComp){var formData,res,newRecipe,res1;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:formData=new FormData();formData.append('file',newRecipeComp.state.file);_context.prev=2;_context.next=5;return axios.post('/images',formData,{headers:{'Content-Type':'multipart/form-data'}});case 5:res=_context.sent;newRecipe={};newRecipe.creatorId=newRecipeComp.state.creatorId;newRecipe.creatorUsername=newRecipeComp.state.creatorUsername;newRecipe.name=newRecipeComp.state.name;if(newRecipeComp.state.description==null){newRecipe.description=\"none\";}else{newRecipe.description=newRecipeComp.state.description;}newRecipe.categories=newRecipeComp.state.categories;newRecipe.ingredients=newRecipeComp.state.ingredients;newRecipe.steps=newRecipeComp.state.steps;newRecipe.imageUrl=res.data.imageUrl;newRecipe.imageId=res.data.imageId;_context.next=18;return axios.post('/api/recipes/',newRecipe);case 18:res1=_context.sent;console.log(newRecipe);alert(\"The Recipe has been succesfully created!\");// add to user's my recipe list\nconsole.log(res1);_context.next=24;return addToRecipeList(newRecipeComp.props.app.state.currentUser._id,{myRecipes:res1.data._id});case 24:newRecipeComp.props.history.push(\"/homepage\");_context.next=30;break;case 27:_context.prev=27;_context.t0=_context[\"catch\"](2);if(_context.t0.res1.status===500){console.log('There was a problem with the server');}else{console.log(_context.t0);}case 30:case\"end\":return _context.stop();}}},_callee,null,[[2,27]]);}));return function addRecipe(_x){return _ref.apply(this,arguments);};}();export var getRecipe=function getRecipe(comp,rid){var request=new Request(\"/api/recipes/\".concat(rid),{method:\"get\",headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});fetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){console.log(json);comp.setState({recipe:json});}).catch(function(error){console.log(error);});};// delete recipe list from all users\nexport var deleteRecipeAllUsers=function deleteRecipeAllUsers(rid,deleteComp){var request=new Request(\"/api/users/\",{method:\"get\",headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});fetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){json.map(function(user){DeleteFromRecipeList(user._id,{myRecipes:rid,likedRecipes:rid,collectedRecipes:rid});}).then(deleteComp.props.history.push(\"/viewprofile/\"+deleteComp.props.app.state.currentUser._id));}).catch(function(error){console.log(error);});};export var deleteRecipe=function deleteRecipe(rid,deleteComp){var request=new Request(\"/api/recipes/\".concat(rid),{method:\"delete\",headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});fetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){// delete the recipe from all user's \ndeleteRecipeAllUsers(rid,deleteComp);}).catch(function(error){console.log(error);});};export var getAllRecipes=function getAllRecipes(comp){var request=new Request(\"/api/recipes\",{method:\"get\",headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});fetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){console.log(json);comp.setState({recipes:json.recipes});comp.setState({displayed_recipes:json.recipes});// update top three recipes\nvar first_largest=-1;var second_largest=-1;var third_largest=-1;var first_idx=-1;var second_idx=-1;var third_idx=-1;for(var i=0;i<json.recipes.length;i++){if(json.recipes[i].likes>=first_largest){third_largest=second_largest;second_largest=first_largest;first_largest=json.recipes[i].likes;third_idx=second_idx;second_idx=first_idx;first_idx=i;}else if(json.recipes[i].likes>=second_largest){third_largest=second_largest;second_largest=json.recipes[i].likes;third_idx=second_idx;second_idx=i;}else if(json.recipes[i].likes>=third_largest){third_largest=json.recipes[i].likes;third_idx=i;}}comp.setState({top3_recipe:[first_idx,second_idx,third_idx]});}).catch(function(error){console.log(error);});};export var getTop2Recipes=function getTop2Recipes(comp,rid){var request=new Request(\"/api/recipes\",{method:\"get\",headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});fetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){console.log(json);comp.setState({recipes:json.recipes});comp.setState({displayed_recipes:json.recipes});// update top 2 recipes\nvar first_largest=-1;var second_largest=-1;var first_recipe=false;var second_recipe=false;for(var i=0;i<json.recipes.length;i++){if(json.recipes[i]._id===rid){continue;}else if(json.recipes[i].likes>=first_largest){second_largest=first_largest;first_largest=json.recipes[i].likes;second_recipe=first_recipe;first_recipe=json.recipes[i];}else if(json.recipes[i].likes>=second_largest){second_largest=json.recipes[i].likes;second_recipe=json.recipes[i];}}comp.setState({top2_recipes:[first_recipe,second_recipe]});}).catch(function(error){console.log(error);});};// set a recipe field \nexport var setRecipe=function setRecipe(rid,newRecipe){axios.patch(\"/api/recipes/\".concat(rid),newRecipe).then(function(res){return console.log(res.data);});};export var updateRecipe=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(comp,newRecipe){var formData,res0,res1;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;if(!newRecipe.file){_context2.next=11;break;}formData=new FormData();formData.append('file',newRecipe.file);_context2.next=6;return axios.post('/images',formData,{headers:{'Content-Type':'multipart/form-data'}});case 6:res0=_context2.sent;newRecipe.imageUrl=res0.data.imageUrl;newRecipe.imageId=res0.data.imageId;comp.state.recipe.imageUrl=newRecipe.imageUrl;comp.state.recipe.imageId=newRecipe.imageId;case 11:_context2.next=13;return axios.patch(\"/api/recipes/\".concat(comp.state.rid),newRecipe);case 13:res1=_context2.sent;console.log(res1);comp.props.history.push(\"/viewrecipe/\"+comp.state.rid);_context2.next=21;break;case 18:_context2.prev=18;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 21:case\"end\":return _context2.stop();}}},_callee2,null,[[0,18]]);}));return function updateRecipe(_x2,_x3){return _ref2.apply(this,arguments);};}();","map":{"version":3,"sources":["/Users/FrankChen/csc309/tp/team07/client/src/actions/recipe.js"],"names":["axios","addToRecipeList","uid","recipeList","request","Request","method","body","JSON","stringify","headers","Accept","console","log","fetch","then","res","status","json","catch","error","DeleteFromRecipeList","getMyRecipe","viewProfileComp","myRecipes","state","user","forEach","rid","push","setState","recipes","getMyCollection","myCollectedRecipes","collectedRecipes","addRecipe","newRecipeComp","formData","FormData","append","file","post","newRecipe","creatorId","creatorUsername","name","description","categories","ingredients","steps","imageUrl","data","imageId","res1","alert","props","app","currentUser","_id","history","getRecipe","comp","recipe","deleteRecipeAllUsers","deleteComp","map","likedRecipes","deleteRecipe","getAllRecipes","displayed_recipes","first_largest","second_largest","third_largest","first_idx","second_idx","third_idx","i","length","likes","top3_recipe","getTop2Recipes","first_recipe","second_recipe","top2_recipes","setRecipe","patch","updateRecipe","res0"],"mappings":"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","sourcesContent":["import axios from \"axios\";\n// modify recipe list of the user\n/*\nadd a new recipe to recipe lists\n{\n    \"likedRecipes\": <rid>,\n    \"collectedRecipes\": <rid>,\n    \"myRecipes\": <rid>\n}\n*/\nexport const addToRecipeList = (uid, recipeList) => {\n    // create our request constructor with all the parameters we need\n    const request = new Request(`/api/users/${uid}`, {\n        method: \"post\",\n        body: JSON.stringify(recipeList),\n        headers: {\n            Accept: \"application/json, text/plain, */*\",\n            \"Content-Type\": \"application/json\"\n        }\n    })\n\n    console.log(request)\n    // send the request with fetch()\n    fetch(request)\n        .then(res=>{\n            if(res.status === 200){\n                return res.json();\n            }\n        })\n        .then(json=>{\n            console.log(json)\n        })\n        .catch(error=>{\n            console.log(error);\n        })\n}\n/*\ndelete a new recipe to recipe lists\n{\n    \"likedRecipes\": <rid>,\n    \"collectedRecipes\": <rid>,\n    \"myRecipes\": <rid>\n}\n*/\nexport const DeleteFromRecipeList = (uid, recipeList) => {\n    // create our request constructor with all the parameters we need\n    const request = new Request(`/api/users/${uid}`, {\n        method: \"delete\",\n        body: JSON.stringify(recipeList),\n        headers: {\n            Accept: \"application/json, text/plain, */*\",\n            \"Content-Type\": \"application/json\"\n        }\n    })\n\n    // send the request with fetch()\n    fetch(request)\n        .then(res=>{\n            if(res.status === 200){\n                return res.json();\n            }\n        })\n        .then(json=>{\n            console.log(json)\n        })\n        .catch(error=>{\n            console.log(error);\n        })\n}\n\nexport const getMyRecipe = (viewProfileComp) => {\n    const myRecipes = []\n    console.log(viewProfileComp.state.user)\n    viewProfileComp.state.user.myRecipes.forEach(rid => {\n        const request = new Request(`/api/recipes/${rid}`, {\n            method: \"get\",\n            headers: {\n                Accept: \"application/json, text/plain, */*\",\n                \"Content-Type\": \"application/json\"\n            }\n        })\n    \n        fetch(request)\n            .then(res=>{\n                if(res.status === 200){\n                    return res.json();\n                }\n            })\n            .then(json=>{\n                if(json){\n                    console.log(json)\n                    myRecipes.push(json)\n                }   \n            })\n            .catch(error=>{\n                console.log(error);\n            })\n        \n    });\n    viewProfileComp.setState({recipes: myRecipes})  \n}\n\nexport const getMyCollection = (viewProfileComp) => {\n    const myCollectedRecipes = []\n    viewProfileComp.state.user.collectedRecipes.forEach(rid => {\n        const request = new Request(`/api/recipes/${rid}`, {\n            method: \"get\",\n            headers: {\n                Accept: \"application/json, text/plain, */*\",\n                \"Content-Type\": \"application/json\"\n            }\n        })\n    \n        fetch(request)\n            .then(res=>{\n                if(res.status === 200){\n                    return res.json();\n                }\n            })\n            .then(json=>{\n                console.log(json)\n                myCollectedRecipes.push(json)\n            })\n            .catch(error=>{\n                console.log(error);\n            })\n        \n    });\n    viewProfileComp.setState({collectedRecipes: myCollectedRecipes})\n}\n\n\nexport const addRecipe = async(newRecipeComp) => {\n    const formData = new FormData();   \n    formData.append('file', newRecipeComp.state.file);\n\n    try{\n        const res = await axios.post('/images', formData, {\n            headers: {\n                'Content-Type': 'multipart/form-data'\n            }\n        })\n\n        const newRecipe = {};\n        newRecipe.creatorId = newRecipeComp.state.creatorId;\n        newRecipe.creatorUsername = newRecipeComp.state.creatorUsername;\n        newRecipe.name = newRecipeComp.state.name;\n        if(newRecipeComp.state.description == null){\n            newRecipe.description = \"none\";\n        }else{\n            newRecipe.description = newRecipeComp.state.description;\n        }\n        newRecipe.categories = newRecipeComp.state.categories;\n        newRecipe.ingredients = newRecipeComp.state.ingredients;\n        newRecipe.steps = newRecipeComp.state.steps;\n        newRecipe.imageUrl = res.data.imageUrl;\n        newRecipe.imageId = res.data.imageId;\n        \n        const res1 = await axios.post('/api/recipes/', newRecipe);\n        console.log(newRecipe)\n        alert(\"The Recipe has been succesfully created!\")\n\n        // add to user's my recipe list\n        console.log(res1)\n        await addToRecipeList(newRecipeComp.props.app.state.currentUser._id, {myRecipes: res1.data._id})\n        newRecipeComp.props.history.push(\"/homepage\")\n    } catch(error) {\n        if(error.res1.status === 500){\n            console.log('There was a problem with the server')\n        } else{\n            console.log(error)\n        }\n    }\n}\n\nexport const getRecipe = (comp, rid) => {\n    const request = new Request(`/api/recipes/${rid}`, {\n        method: \"get\",\n        headers: {\n            Accept: \"application/json, text/plain, */*\",\n            \"Content-Type\": \"application/json\"\n        }\n    })\n\n    fetch(request)\n        .then(res=>{\n            if(res.status === 200){\n                return res.json();\n            }\n        })\n        .then(json=>{\n            console.log(json)\n            comp.setState({recipe: json})\n        })\n        .catch(error=>{\n            console.log(error);\n        })\n}\n\n// delete recipe list from all users\nexport const deleteRecipeAllUsers = (rid, deleteComp) => {\n    const request = new Request(`/api/users/`, {\n        method: \"get\",\n        headers: {\n            Accept: \"application/json, text/plain, */*\",\n            \"Content-Type\": \"application/json\"\n        }\n    })\n\n    fetch(request)\n        .then(res=>{\n            if(res.status === 200){\n                return res.json();\n            }\n        })\n        .then(json=>{\n            json.map(user=>{\n                DeleteFromRecipeList(user._id, \n                    {myRecipes: rid, likedRecipes: rid, collectedRecipes: rid}\n                )\n            }).then(\n                deleteComp.props.history.push(\"/viewprofile/\"+ deleteComp.props.app.state.currentUser._id)\n            )\n        })\n        .catch(error=>{\n            console.log(error);\n        })\n\n}\n\nexport const deleteRecipe = (rid, deleteComp) => {\n    const request = new Request(`/api/recipes/${rid}`, {\n        method: \"delete\",\n        headers: {\n            Accept: \"application/json, text/plain, */*\",\n            \"Content-Type\": \"application/json\"\n        }\n    })\n\n    fetch(request)\n        .then(res=>{\n            if(res.status === 200){\n                return res.json();\n            }\n        })\n        .then(json=>{\n            // delete the recipe from all user's \n                deleteRecipeAllUsers(rid, deleteComp)\n        })\n        .catch(error=>{\n            console.log(error);\n        })\n}\n\nexport const getAllRecipes = (comp)=>{\n    const request = new Request(`/api/recipes`, {\n        method: \"get\",\n        headers: {\n            Accept: \"application/json, text/plain, */*\",\n            \"Content-Type\": \"application/json\"\n        }\n    })\n\n    fetch(request)\n        .then(res=>{\n            if(res.status === 200){\n                return res.json();\n            }\n        })\n        .then(json=>{\n            console.log(json)\n            comp.setState({recipes: json.recipes})\n            comp.setState({displayed_recipes: json.recipes})\n            \n            // update top three recipes\n            let first_largest = -1;\n            let second_largest = -1;\n            let third_largest = -1;\n            let first_idx = -1;\n            let second_idx = -1;\n            let third_idx = -1;\n            for(let i=0; i< json.recipes.length; i++){\n                if(json.recipes[i].likes >= first_largest){\n                    third_largest = second_largest;\n                    second_largest = first_largest;\n                    first_largest = json.recipes[i].likes;\n                    third_idx = second_idx;\n                    second_idx = first_idx;\n                    first_idx = i;\n                }else if(json.recipes[i].likes >= second_largest){\n                    third_largest = second_largest;\n                    second_largest = json.recipes[i].likes;\n                    third_idx = second_idx;\n                    second_idx = i;\n                }else if(json.recipes[i].likes >= third_largest){\n                    third_largest = json.recipes[i].likes;\n                    third_idx = i;\n                }\n            }\n            comp.setState({ top3_recipe: [first_idx, second_idx, third_idx]})\n        })\n        .catch(error=>{\n            console.log(error);\n        })\n}\n\nexport const getTop2Recipes = (comp, rid)=>{\n    const request = new Request(`/api/recipes`, {\n        method: \"get\",\n        headers: {\n            Accept: \"application/json, text/plain, */*\",\n            \"Content-Type\": \"application/json\"\n        }\n    })\n\n    fetch(request)\n        .then(res=>{\n            if(res.status === 200){\n                return res.json();\n            }\n        })\n        .then(json=>{\n            console.log(json)\n            comp.setState({recipes: json.recipes})\n            comp.setState({displayed_recipes: json.recipes})\n            // update top 2 recipes\n            let first_largest = -1;\n            let second_largest = -1;\n            let first_recipe = false;\n            let second_recipe = false;\n            for(let i=0; i< json.recipes.length; i++){\n                if(json.recipes[i]._id === rid){\n                    continue;\n                }else if(json.recipes[i].likes >= first_largest){\n                    second_largest = first_largest;\n                    first_largest = json.recipes[i].likes;\n                    second_recipe = first_recipe;\n                    first_recipe = json.recipes[i];\n                }else if(json.recipes[i].likes >= second_largest){\n                    second_largest = json.recipes[i].likes;\n                    second_recipe = json.recipes[i];\n                }\n            }\n            \n            comp.setState({ top2_recipes: [first_recipe, second_recipe]})\n        })\n        .catch(error=>{\n            console.log(error);\n        })\n}\n\n// set a recipe field \nexport const setRecipe = (rid, newRecipe) => {\n    axios.patch(`/api/recipes/${rid}`, newRecipe)\n    .then(res => console.log(res.data));\n}\n\nexport const updateRecipe = async(comp, newRecipe) => {\n    try {\n        if (newRecipe.file){\n            const formData = new FormData();   \n            formData.append('file', newRecipe.file);\n            \n            const res0 = await axios.post('/images', formData, {\n                headers: {\n                    'Content-Type': 'multipart/form-data'\n                }\n            })\n            newRecipe.imageUrl = res0.data.imageUrl\n            newRecipe.imageId = res0.data.imageId\n            comp.state.recipe.imageUrl = newRecipe.imageUrl\n            comp.state.recipe.imageId = newRecipe.imageId\n            \n        }\n        const res1 = await axios.patch(`/api/recipes/${comp.state.rid}`, newRecipe)\n        console.log(res1)\n        comp.props.history.push(\"/viewrecipe/\"+ comp.state.rid)\n    } catch (error){\n        console.log(error)\n    }\n}"]},"metadata":{},"sourceType":"module"}